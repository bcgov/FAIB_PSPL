---
title: "Process Coefficients"
author: "dwaddell"
date: '2022-05-20'
output: html_document
---


## test process for coefficinets in table for sit eindex conversion



```{r}

library(tidyverse)


# table of conversion coefficients
coef <- data.frame('s1' = c('at','at'),'s2' = c('sw','bl'),'b0' = c(-5,-7), 'b1' = c(1.3,1.5))

# test data
si_data <- data.frame('id' = c(1,2,3),'at_si' = c(0,0,0),'bl_si' = c(0,17,0),'fd_si' = c(21,25,18),'sw_si' = c(15,0,0))


# process for at_si == 0
si_data$at_si[which(si_data$at_si==0)] <- convert_si(si_data[which(si_data$at_si==0)],'at')
si_sub <- si_data[si_data$id==1,]

sp <- 'at'

convert_si <- function(dt,sp){
  
  # get the set of coefficients that apply to the species
  cx <- coef %>% subset(s1 == sp)
  
  # set of characters
  sp_order <- cx$s2
  
  # find first si species in list with si > 0
  
  for (spx in length(sp_order)){
    
    non_zero <- which(si_sub !=0)
    first <- which(grepl(sp_order[1],names(si_sub)))
    
    
    
    
    
  }
  
  
}




```
